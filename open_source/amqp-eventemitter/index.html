<!DOCTYPE html><html class="no-js" lang="en"><head><meta charset="utf-8" /><title>AMQP EventEmitter | Bites from Good Eggs</title><meta name="author" content="Alex Gorbatchev" /><meta name="viewport" content="width=device-width, initial-scale=1" /><link rel="icon" type="image/png" href="../../favicon.png" /><link rel="stylesheet" href="../../styles/main.css" /><link rel="alternate" title="RSS" type="application/rss+xml" href="../../rss" /><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-26193287-5', 'github.io');
ga('send', 'pageview');</script></head><body><header><h1><a href="../../">Bites</a></h1><ul class="unstyled nav"><li><a href="../../">Blog</a></li><li><a href="../../open_source">Open Source</a></li><li><a href="../../news">News</a></li></ul></header><div id="main"><div id="content"><div><article class="hentry" role="article"><header><h1 class="entry-title">AMQP EventEmitter</h1><p class="meta"><a href="../../authors/alex_gorbatchev/">Alex Gorbatchev</a> on <time datetime="2013-11-18T00:00:00.000Z">November 18th, 2013</time></p></header><div class="entry-content"><p>EventEmitter over AMQP! Nothing more, nothing less! Check it out on <a href="https://github.com/goodeggs/amqp-eventemitter">GitHub</a> or:</p>
<pre class="highlighted"><code class="nginx"><span class="title">npm</span> install amqp-eventemitter</code></pre>
<p>Works really well with <a href="http://www.rabbitmq.com/">RabbitMQ</a> or any other AMQP.</p>
<!-- more -->

<h2 id="usage">Usage</h2>
<pre class="highlighted"><code class="coffeescript">{AmqpEventEmitter} = require <span class="string">'amqp-eventemitter'</span>

pub = <span class="keyword">new</span> AmqpEventEmitter url: <span class="string">'amqp://guest:guest@localhost:5672'</span>
sub = <span class="keyword">new</span> AmqpEventEmitter url: <span class="string">'amqp://guest:guest@localhost:5672'</span>

sub.<span class="literal">on</span> <span class="string">'message'</span>, (arg1, arg2) -&gt; console.log arg1, arg2
pub.emit <span class="string">'message'</span>, <span class="string">'hello'</span>, <span class="string">'world'</span>

<span class="comment">#=&gt; hello world</span></code></pre>
<h2 id="api">API</h2>
<h3 id="new-amqpeventemitter-options-">new AmqpEventEmitter(options)</h3>
<p>Options are passed to respective functions in <a href="https://github.com/postwait/node-amqp"><code>node-amqp</code></a>, eg. <code>options.exchange</code> is passed to <code>connection.createExchange</code> and so on. Here are the default values:</p>
<pre class="highlighted"><code class="smalltalk">options =
  <span class="method">connection:</span>
      <span class="method">url:</span> <span class="string">'amqp://...'</span>
  <span class="method">exchange:</span>
      <span class="method">name:</span> <span class="string">'amqp-eventemitter'</span>
      <span class="method">type:</span> <span class="string">'fanout'</span>
      <span class="method">autoDelete:</span> <span class="keyword">true</span>
  <span class="method">queue:</span>
      <span class="method">name:</span> exchange.name + <span class="string">'.'</span> + uuid</code></pre>
<p>or you can take a shortcut and just pass AMQP connection string.</p>
<pre class="highlighted"><code class="brainfuck"><span class="comment">options</span> <span class="comment">=</span> <span class="comment">url:</span> <span class="comment">'amqp://</span>.<span class="string">.</span><span class="string">.</span><span class="comment">'</code></pre>
<h2 id="notes">Notes</h2>
<ul>
<li><strong>Each instance of <code>AmqpEventEmitter</code> receives each emitted event.</strong></li>
<li>You can immediately emit events without waiting for AMQP connection.</li>
<li><code>amqp-eventemitter.ready</code> is emitted when connection is actually made, exchange created and queue bound.</li>
</ul>
<p><strong>Are you using this module? Please tell us how!</strong></p>
</div><footer><p class="meta"></p><div id="disqus_thread"></div><script>window.disqus_shortname = 'goodeggsbytes'; window.disqus_url = 'http://bites.goodeggs.com/posts/amqp-eventemitter/'</script><script async="async" src="//goodeggsbytes.disqus.com/embed.js"></script></footer></article></div></div></div><footer><div class="mission">Our mission is to grow and sustain local food systems worldwide.</div><p>Â©2013 Good Eggs, Inc</p></footer></body></html>